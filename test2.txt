import pandas as pd

# Load the Excel data into a DataFrame
data = pd.read_excel('hotel_data.xlsx')

import nltk
from nltk.corpus import stopwords
from nltk.tokenize import word_tokenize

import string

# Download stopwords and punctuation from NLTK
nltk.download('stopwords')
nltk.download('punkt')

# Remove punctuation and convert text to lowercase
data['clean_text'] = data['text_column'].apply(lambda x: x.translate(str.maketrans('', '', string.punctuation)).lower())

# Tokenize the text
data['tokens'] = data['clean_text'].apply(word_tokenize)

# Remove stop words
stop_words = set(stopwords.words('english'))
data['tokens'] = data['tokens'].apply(lambda x: [word for word in x if word not in stop_words])


from nltk.sentiment import SentimentIntensityAnalyzer

# Initialize the VADER sentiment analyzer
sia = SentimentIntensityAnalyzer()

# Apply sentiment analysis and assign sentiment scores
data['sentiment_scores'] = data['clean_text'].apply(lambda x: sia.polarity_scores(x))

# Extract the compound sentiment score
data['compound_score'] = data['sentiment_scores'].apply(lambda x: x['compound'])

# Classify sentiment based on the compound score
data['sentiment'] = data['compound_score'].apply(lambda x: 'Positive' if x > 0 else 'Negative' if x < 0 else 'Neutral')
